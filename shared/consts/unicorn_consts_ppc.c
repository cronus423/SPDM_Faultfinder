#include <string.h>
#include <stdbool.h>
#include <unicorn/unicorn.h>
#include "../utils.h"
#include "../unicorn_consts.h"
#include "../configuration.h"
#include "unicorn_consts_ppc.h"


uint64_t uc_cpu_from_name_ppc(const char* cpu_name)
{
    static unicorn_const_t const cpu_array[]=
    {  
        {"401",UC_CPU_PPC32_401},{"401A1",UC_CPU_PPC32_401A1},{"401B2",UC_CPU_PPC32_401B2},{"401C2",UC_CPU_PPC32_401C2},{"401D2",UC_CPU_PPC32_401D2},{"401E2",UC_CPU_PPC32_401E2},{"401F2",UC_CPU_PPC32_401F2},{"401G2",UC_CPU_PPC32_401G2},{"IOP480",UC_CPU_PPC32_IOP480},{"COBRA",UC_CPU_PPC32_COBRA},{"403GA",UC_CPU_PPC32_403GA},{"403GB",UC_CPU_PPC32_403GB},{"403GC",UC_CPU_PPC32_403GC},{"403GCX",UC_CPU_PPC32_403GCX},{"405D2",UC_CPU_PPC32_405D2},{"405D4",UC_CPU_PPC32_405D4},{"405CRA",UC_CPU_PPC32_405CRA},{"405CRB",UC_CPU_PPC32_405CRB},{"405CRC",UC_CPU_PPC32_405CRC},{"405EP",UC_CPU_PPC32_405EP},{"405EZ",UC_CPU_PPC32_405EZ},{"405GPA",UC_CPU_PPC32_405GPA},{"405GPB",UC_CPU_PPC32_405GPB},{"405GPC",UC_CPU_PPC32_405GPC},{"405GPD",UC_CPU_PPC32_405GPD},{"405GPR",UC_CPU_PPC32_405GPR},{"405LP",UC_CPU_PPC32_405LP},{"NPE405H",UC_CPU_PPC32_NPE405H},{"NPE405H2",UC_CPU_PPC32_NPE405H2},{"NPE405L",UC_CPU_PPC32_NPE405L},{"NPE4GS3",UC_CPU_PPC32_NPE4GS3},{"STB03",UC_CPU_PPC32_STB03},{"STB04",UC_CPU_PPC32_STB04},{"STB25",UC_CPU_PPC32_STB25},{"X2VP4",UC_CPU_PPC32_X2VP4},{"X2VP20",UC_CPU_PPC32_X2VP20},{"440_XILINX",UC_CPU_PPC32_440_XILINX},{"440_XILINX_W_DFPU",UC_CPU_PPC32_440_XILINX_W_DFPU},{"440EPA",UC_CPU_PPC32_440EPA},{"440EPB",UC_CPU_PPC32_440EPB},{"440EPX",UC_CPU_PPC32_440EPX},{"460EXB",UC_CPU_PPC32_460EXB},{"G2",UC_CPU_PPC32_G2},{"G2H4",UC_CPU_PPC32_G2H4},{"G2GP",UC_CPU_PPC32_G2GP},{"G2LS",UC_CPU_PPC32_G2LS},{"G2HIP3",UC_CPU_PPC32_G2HIP3},{"G2HIP4",UC_CPU_PPC32_G2HIP4},{"MPC603",UC_CPU_PPC32_MPC603},{"G2LE",UC_CPU_PPC32_G2LE},{"G2LEGP",UC_CPU_PPC32_G2LEGP},{"G2LELS",UC_CPU_PPC32_G2LELS},{"G2LEGP1",UC_CPU_PPC32_G2LEGP1},{"G2LEGP3",UC_CPU_PPC32_G2LEGP3},{"MPC5200_V10",UC_CPU_PPC32_MPC5200_V10},{"MPC5200_V11",UC_CPU_PPC32_MPC5200_V11},{"MPC5200_V12",UC_CPU_PPC32_MPC5200_V12},{"MPC5200B_V20",UC_CPU_PPC32_MPC5200B_V20},{"MPC5200B_V21",UC_CPU_PPC32_MPC5200B_V21},{"E200Z5",UC_CPU_PPC32_E200Z5},{"E200Z6",UC_CPU_PPC32_E200Z6},{"E300C1",UC_CPU_PPC32_E300C1},{"E300C2",UC_CPU_PPC32_E300C2},{"E300C3",UC_CPU_PPC32_E300C3},{"E300C4",UC_CPU_PPC32_E300C4},{"MPC8343",UC_CPU_PPC32_MPC8343},{"MPC8343A",UC_CPU_PPC32_MPC8343A},{"MPC8343E",UC_CPU_PPC32_MPC8343E},{"MPC8343EA",UC_CPU_PPC32_MPC8343EA},{"MPC8347T",UC_CPU_PPC32_MPC8347T},{"MPC8347P",UC_CPU_PPC32_MPC8347P},{"MPC8347AT",UC_CPU_PPC32_MPC8347AT},{"MPC8347AP",UC_CPU_PPC32_MPC8347AP},{"MPC8347ET",UC_CPU_PPC32_MPC8347ET},{"MPC8347EP",UC_CPU_PPC32_MPC8347EP},{"MPC8347EAT",UC_CPU_PPC32_MPC8347EAT},{"MPC8347EAP",UC_CPU_PPC32_MPC8347EAP},{"MPC8349",UC_CPU_PPC32_MPC8349},{"MPC8349A",UC_CPU_PPC32_MPC8349A},{"MPC8349E",UC_CPU_PPC32_MPC8349E},{"MPC8349EA",UC_CPU_PPC32_MPC8349EA},{"MPC8377",UC_CPU_PPC32_MPC8377},{"MPC8377E",UC_CPU_PPC32_MPC8377E},{"MPC8378",UC_CPU_PPC32_MPC8378},{"MPC8378E",UC_CPU_PPC32_MPC8378E},{"MPC8379",UC_CPU_PPC32_MPC8379},{"MPC8379E",UC_CPU_PPC32_MPC8379E},{"E500_V10",UC_CPU_PPC32_E500_V10},{"E500_V20",UC_CPU_PPC32_E500_V20},{"E500V2_V10",UC_CPU_PPC32_E500V2_V10},{"E500V2_V20",UC_CPU_PPC32_E500V2_V20},{"E500V2_V21",UC_CPU_PPC32_E500V2_V21},{"E500V2_V22",UC_CPU_PPC32_E500V2_V22},{"E500V2_V30",UC_CPU_PPC32_E500V2_V30},{"E500MC",UC_CPU_PPC32_E500MC},{"MPC8533_V10",UC_CPU_PPC32_MPC8533_V10},{"MPC8533_V11",UC_CPU_PPC32_MPC8533_V11},{"MPC8533E_V10",UC_CPU_PPC32_MPC8533E_V10},{"MPC8533E_V11",UC_CPU_PPC32_MPC8533E_V11},{"MPC8540_V10",UC_CPU_PPC32_MPC8540_V10},{"MPC8540_V20",UC_CPU_PPC32_MPC8540_V20},{"MPC8540_V21",UC_CPU_PPC32_MPC8540_V21},{"MPC8541_V10",UC_CPU_PPC32_MPC8541_V10},{"MPC8541_V11",UC_CPU_PPC32_MPC8541_V11},{"MPC8541E_V10",UC_CPU_PPC32_MPC8541E_V10},{"MPC8541E_V11",UC_CPU_PPC32_MPC8541E_V11},{"MPC8543_V10",UC_CPU_PPC32_MPC8543_V10},{"MPC8543_V11",UC_CPU_PPC32_MPC8543_V11},{"MPC8543_V20",UC_CPU_PPC32_MPC8543_V20},{"MPC8543_V21",UC_CPU_PPC32_MPC8543_V21},{"MPC8543E_V10",UC_CPU_PPC32_MPC8543E_V10},{"MPC8543E_V11",UC_CPU_PPC32_MPC8543E_V11},{"MPC8543E_V20",UC_CPU_PPC32_MPC8543E_V20},{"MPC8543E_V21",UC_CPU_PPC32_MPC8543E_V21},{"MPC8544_V10",UC_CPU_PPC32_MPC8544_V10},{"MPC8544_V11",UC_CPU_PPC32_MPC8544_V11},{"MPC8544E_V10",UC_CPU_PPC32_MPC8544E_V10},{"MPC8544E_V11",UC_CPU_PPC32_MPC8544E_V11},{"MPC8545_V20",UC_CPU_PPC32_MPC8545_V20},{"MPC8545_V21",UC_CPU_PPC32_MPC8545_V21},{"MPC8545E_V20",UC_CPU_PPC32_MPC8545E_V20},{"MPC8545E_V21",UC_CPU_PPC32_MPC8545E_V21},{"MPC8547E_V20",UC_CPU_PPC32_MPC8547E_V20},{"MPC8547E_V21",UC_CPU_PPC32_MPC8547E_V21},{"MPC8548_V10",UC_CPU_PPC32_MPC8548_V10},{"MPC8548_V11",UC_CPU_PPC32_MPC8548_V11},{"MPC8548_V20",UC_CPU_PPC32_MPC8548_V20},{"MPC8548_V21",UC_CPU_PPC32_MPC8548_V21},{"MPC8548E_V10",UC_CPU_PPC32_MPC8548E_V10},{"MPC8548E_V11",UC_CPU_PPC32_MPC8548E_V11},{"MPC8548E_V20",UC_CPU_PPC32_MPC8548E_V20},{"MPC8548E_V21",UC_CPU_PPC32_MPC8548E_V21},{"MPC8555_V10",UC_CPU_PPC32_MPC8555_V10},{"MPC8555_V11",UC_CPU_PPC32_MPC8555_V11},{"MPC8555E_V10",UC_CPU_PPC32_MPC8555E_V10},{"MPC8555E_V11",UC_CPU_PPC32_MPC8555E_V11},{"MPC8560_V10",UC_CPU_PPC32_MPC8560_V10},{"MPC8560_V20",UC_CPU_PPC32_MPC8560_V20},{"MPC8560_V21",UC_CPU_PPC32_MPC8560_V21},{"MPC8567",UC_CPU_PPC32_MPC8567},{"MPC8567E",UC_CPU_PPC32_MPC8567E},{"MPC8568",UC_CPU_PPC32_MPC8568},{"MPC8568E",UC_CPU_PPC32_MPC8568E},{"MPC8572",UC_CPU_PPC32_MPC8572},{"MPC8572E",UC_CPU_PPC32_MPC8572E},{"E600",UC_CPU_PPC32_E600},{"MPC8610",UC_CPU_PPC32_MPC8610},{"MPC8641",UC_CPU_PPC32_MPC8641},{"MPC8641D",UC_CPU_PPC32_MPC8641D},{"601_V0",UC_CPU_PPC32_601_V0},{"601_V1",UC_CPU_PPC32_601_V1},{"601_V2",UC_CPU_PPC32_601_V2},{"602",UC_CPU_PPC32_602},{"603",UC_CPU_PPC32_603},{"603E_V1_1",UC_CPU_PPC32_603E_V1_1},{"603E_V1_2",UC_CPU_PPC32_603E_V1_2},{"603E_V1_3",UC_CPU_PPC32_603E_V1_3},{"603E_V1_4",UC_CPU_PPC32_603E_V1_4},{"603E_V2_2",UC_CPU_PPC32_603E_V2_2},{"603E_V3",UC_CPU_PPC32_603E_V3},{"603E_V4",UC_CPU_PPC32_603E_V4},{"603E_V4_1",UC_CPU_PPC32_603E_V4_1},{"603E7",UC_CPU_PPC32_603E7},{"603E7T",UC_CPU_PPC32_603E7T},{"603E7V",UC_CPU_PPC32_603E7V},{"603E7V1",UC_CPU_PPC32_603E7V1},{"603E7V2",UC_CPU_PPC32_603E7V2},{"603P",UC_CPU_PPC32_603P},{"604",UC_CPU_PPC32_604},{"604E_V1_0",UC_CPU_PPC32_604E_V1_0},{"604E_V2_2",UC_CPU_PPC32_604E_V2_2},{"604E_V2_4",UC_CPU_PPC32_604E_V2_4},{"604R",UC_CPU_PPC32_604R},{"740_V1_0",UC_CPU_PPC32_740_V1_0},{"750_V1_0",UC_CPU_PPC32_750_V1_0},{"740_V2_0",UC_CPU_PPC32_740_V2_0},{"750_V2_0",UC_CPU_PPC32_750_V2_0},{"740_V2_1",UC_CPU_PPC32_740_V2_1},{"750_V2_1",UC_CPU_PPC32_750_V2_1},{"740_V2_2",UC_CPU_PPC32_740_V2_2},{"750_V2_2",UC_CPU_PPC32_750_V2_2},{"740_V3_0",UC_CPU_PPC32_740_V3_0},{"750_V3_0",UC_CPU_PPC32_750_V3_0},{"740_V3_1",UC_CPU_PPC32_740_V3_1},{"750_V3_1",UC_CPU_PPC32_750_V3_1},{"740E",UC_CPU_PPC32_740E},{"750E",UC_CPU_PPC32_750E},{"740P",UC_CPU_PPC32_740P},{"750P",UC_CPU_PPC32_750P},{"750CL_V1_0",UC_CPU_PPC32_750CL_V1_0},{"750CL_V2_0",UC_CPU_PPC32_750CL_V2_0},{"750CX_V1_0",UC_CPU_PPC32_750CX_V1_0},{"750CX_V2_0",UC_CPU_PPC32_750CX_V2_0},{"750CX_V2_1",UC_CPU_PPC32_750CX_V2_1},{"750CX_V2_2",UC_CPU_PPC32_750CX_V2_2},{"750CXE_V2_1",UC_CPU_PPC32_750CXE_V2_1},{"750CXE_V2_2",UC_CPU_PPC32_750CXE_V2_2},{"750CXE_V2_3",UC_CPU_PPC32_750CXE_V2_3},{"750CXE_V2_4",UC_CPU_PPC32_750CXE_V2_4},{"750CXE_V2_4B",UC_CPU_PPC32_750CXE_V2_4B},{"750CXE_V3_0",UC_CPU_PPC32_750CXE_V3_0},{"750CXE_V3_1",UC_CPU_PPC32_750CXE_V3_1},{"750CXE_V3_1B",UC_CPU_PPC32_750CXE_V3_1B},{"750CXR",UC_CPU_PPC32_750CXR},{"750FL",UC_CPU_PPC32_750FL},{"750FX_V1_0",UC_CPU_PPC32_750FX_V1_0},{"750FX_V2_0",UC_CPU_PPC32_750FX_V2_0},{"750FX_V2_1",UC_CPU_PPC32_750FX_V2_1},{"750FX_V2_2",UC_CPU_PPC32_750FX_V2_2},{"750FX_V2_3",UC_CPU_PPC32_750FX_V2_3},{"750GL",UC_CPU_PPC32_750GL},{"750GX_V1_0",UC_CPU_PPC32_750GX_V1_0},{"750GX_V1_1",UC_CPU_PPC32_750GX_V1_1},{"750GX_V1_2",UC_CPU_PPC32_750GX_V1_2},{"750L_V2_0",UC_CPU_PPC32_750L_V2_0},{"750L_V2_1",UC_CPU_PPC32_750L_V2_1},{"750L_V2_2",UC_CPU_PPC32_750L_V2_2},{"750L_V3_0",UC_CPU_PPC32_750L_V3_0},{"750L_V3_2",UC_CPU_PPC32_750L_V3_2},{"745_V1_0",UC_CPU_PPC32_745_V1_0},{"755_V1_0",UC_CPU_PPC32_755_V1_0},{"745_V1_1",UC_CPU_PPC32_745_V1_1},{"755_V1_1",UC_CPU_PPC32_755_V1_1},{"745_V2_0",UC_CPU_PPC32_745_V2_0},{"755_V2_0",UC_CPU_PPC32_755_V2_0},{"745_V2_1",UC_CPU_PPC32_745_V2_1},{"755_V2_1",UC_CPU_PPC32_755_V2_1},{"745_V2_2",UC_CPU_PPC32_745_V2_2},{"755_V2_2",UC_CPU_PPC32_755_V2_2},{"745_V2_3",UC_CPU_PPC32_745_V2_3},{"755_V2_3",UC_CPU_PPC32_755_V2_3},{"745_V2_4",UC_CPU_PPC32_745_V2_4},{"755_V2_4",UC_CPU_PPC32_755_V2_4},{"745_V2_5",UC_CPU_PPC32_745_V2_5},{"755_V2_5",UC_CPU_PPC32_755_V2_5},{"745_V2_6",UC_CPU_PPC32_745_V2_6},{"755_V2_6",UC_CPU_PPC32_755_V2_6},{"745_V2_7",UC_CPU_PPC32_745_V2_7},{"755_V2_7",UC_CPU_PPC32_755_V2_7},{"745_V2_8",UC_CPU_PPC32_745_V2_8},{"755_V2_8",UC_CPU_PPC32_755_V2_8},{"7400_V1_0",UC_CPU_PPC32_7400_V1_0},{"7400_V1_1",UC_CPU_PPC32_7400_V1_1},{"7400_V2_0",UC_CPU_PPC32_7400_V2_0},{"7400_V2_1",UC_CPU_PPC32_7400_V2_1},{"7400_V2_2",UC_CPU_PPC32_7400_V2_2},{"7400_V2_6",UC_CPU_PPC32_7400_V2_6},{"7400_V2_7",UC_CPU_PPC32_7400_V2_7},{"7400_V2_8",UC_CPU_PPC32_7400_V2_8},{"7400_V2_9",UC_CPU_PPC32_7400_V2_9},{"7410_V1_0",UC_CPU_PPC32_7410_V1_0},{"7410_V1_1",UC_CPU_PPC32_7410_V1_1},{"7410_V1_2",UC_CPU_PPC32_7410_V1_2},{"7410_V1_3",UC_CPU_PPC32_7410_V1_3},{"7410_V1_4",UC_CPU_PPC32_7410_V1_4},{"7448_V1_0",UC_CPU_PPC32_7448_V1_0},{"7448_V1_1",UC_CPU_PPC32_7448_V1_1},{"7448_V2_0",UC_CPU_PPC32_7448_V2_0},{"7448_V2_1",UC_CPU_PPC32_7448_V2_1},{"7450_V1_0",UC_CPU_PPC32_7450_V1_0},{"7450_V1_1",UC_CPU_PPC32_7450_V1_1},{"7450_V1_2",UC_CPU_PPC32_7450_V1_2},{"7450_V2_0",UC_CPU_PPC32_7450_V2_0},{"7450_V2_1",UC_CPU_PPC32_7450_V2_1},{"7441_V2_1",UC_CPU_PPC32_7441_V2_1},{"7441_V2_3",UC_CPU_PPC32_7441_V2_3},{"7451_V2_3",UC_CPU_PPC32_7451_V2_3},{"7441_V2_10",UC_CPU_PPC32_7441_V2_10},{"7451_V2_10",UC_CPU_PPC32_7451_V2_10},{"7445_V1_0",UC_CPU_PPC32_7445_V1_0},{"7455_V1_0",UC_CPU_PPC32_7455_V1_0},{"7445_V2_1",UC_CPU_PPC32_7445_V2_1},{"7455_V2_1",UC_CPU_PPC32_7455_V2_1},{"7445_V3_2",UC_CPU_PPC32_7445_V3_2},{"7455_V3_2",UC_CPU_PPC32_7455_V3_2},{"7445_V3_3",UC_CPU_PPC32_7445_V3_3},{"7455_V3_3",UC_CPU_PPC32_7455_V3_3},{"7445_V3_4",UC_CPU_PPC32_7445_V3_4},{"7455_V3_4",UC_CPU_PPC32_7455_V3_4},{"7447_V1_0",UC_CPU_PPC32_7447_V1_0},{"7457_V1_0",UC_CPU_PPC32_7457_V1_0},{"7447_V1_1",UC_CPU_PPC32_7447_V1_1},{"7457_V1_1",UC_CPU_PPC32_7457_V1_1},{"7457_V1_2",UC_CPU_PPC32_7457_V1_2},{"7447A_V1_0",UC_CPU_PPC32_7447A_V1_0},{"7457A_V1_0",UC_CPU_PPC32_7457A_V1_0},{"7447A_V1_1",UC_CPU_PPC32_7447A_V1_1},{"7457A_V1_1",UC_CPU_PPC32_7457A_V1_1},{"7447A_V1_2",UC_CPU_PPC32_7447A_V1_2},{"7457A_V1_2",UC_CPU_PPC32_7457A_V1_2}
    };

    const int numEntries=sizeof(cpu_array) / sizeof(cpu_array[0]);
    for (int i=0;i<numEntries;i++)
    {
        if (strcasecmp(cpu_name,cpu_array[i].name) == 0)
        {
            return cpu_array[i].unicorn_value;
        }

    }
    fprintf(stderr, "Error %s is not a valid CPU for ppc.\n",cpu_name);
    fprintf(stderr, "Valid choices are:");
    for (int i=0;i<numEntries;i++)
    {
        fprintf(stderr, "%s ",cpu_array[i].name);
    }
    fprintf(stderr, "\n");
    my_exit(-1);
    return 666;  /// just here to keep the compiler happy. 
}


/************************************************** uc_reg_from_int_ppc and register_name_from_int_ppc MUST MATCH ************************************/
uint64_t uc_reg_from_int_ppc(uint64_t index)
{
    static unicorn_const_t const register_array[]={
        {"PC",UC_PPC_REG_PC},{"0",UC_PPC_REG_0},{"1",UC_PPC_REG_1},{"2",UC_PPC_REG_2},{"3",UC_PPC_REG_3},{"4",UC_PPC_REG_4},{"5",UC_PPC_REG_5},{"6",UC_PPC_REG_6},{"7",UC_PPC_REG_7},{"8",UC_PPC_REG_8},{"9",UC_PPC_REG_9},{"10",UC_PPC_REG_10},{"11",UC_PPC_REG_11},{"12",UC_PPC_REG_12},{"13",UC_PPC_REG_13},{"14",UC_PPC_REG_14},{"15",UC_PPC_REG_15},{"16",UC_PPC_REG_16},{"17",UC_PPC_REG_17},{"18",UC_PPC_REG_18},{"19",UC_PPC_REG_19},{"20",UC_PPC_REG_20},{"21",UC_PPC_REG_21},{"22",UC_PPC_REG_22},{"23",UC_PPC_REG_23},{"24",UC_PPC_REG_24},{"25",UC_PPC_REG_25},{"26",UC_PPC_REG_26},{"27",UC_PPC_REG_27},{"28",UC_PPC_REG_28},{"29",UC_PPC_REG_29},{"30",UC_PPC_REG_30},{"31",UC_PPC_REG_31},{"CR0",UC_PPC_REG_CR0},{"CR1",UC_PPC_REG_CR1},{"CR2",UC_PPC_REG_CR2},{"CR3",UC_PPC_REG_CR3},{"CR4",UC_PPC_REG_CR4},{"CR5",UC_PPC_REG_CR5},{"CR6",UC_PPC_REG_CR6},{"CR7",UC_PPC_REG_CR7},{"FPR0",UC_PPC_REG_FPR0},{"FPR1",UC_PPC_REG_FPR1},{"FPR2",UC_PPC_REG_FPR2},{"FPR3",UC_PPC_REG_FPR3},{"FPR4",UC_PPC_REG_FPR4},{"FPR5",UC_PPC_REG_FPR5},{"FPR6",UC_PPC_REG_FPR6},{"FPR7",UC_PPC_REG_FPR7},{"FPR8",UC_PPC_REG_FPR8},{"FPR9",UC_PPC_REG_FPR9},{"FPR10",UC_PPC_REG_FPR10},{"FPR11",UC_PPC_REG_FPR11},{"FPR12",UC_PPC_REG_FPR12},{"FPR13",UC_PPC_REG_FPR13},{"FPR14",UC_PPC_REG_FPR14},{"FPR15",UC_PPC_REG_FPR15},{"FPR16",UC_PPC_REG_FPR16},{"FPR17",UC_PPC_REG_FPR17},{"FPR18",UC_PPC_REG_FPR18},{"FPR19",UC_PPC_REG_FPR19},{"FPR20",UC_PPC_REG_FPR20},{"FPR21",UC_PPC_REG_FPR21},{"FPR22",UC_PPC_REG_FPR22},{"FPR23",UC_PPC_REG_FPR23},{"FPR24",UC_PPC_REG_FPR24},{"FPR25",UC_PPC_REG_FPR25},{"FPR26",UC_PPC_REG_FPR26},{"FPR27",UC_PPC_REG_FPR27},{"FPR28",UC_PPC_REG_FPR28},{"FPR29",UC_PPC_REG_FPR29},{"FPR30",UC_PPC_REG_FPR30},{"FPR31",UC_PPC_REG_FPR31},{"LR",UC_PPC_REG_LR},{"XER",UC_PPC_REG_XER},{"CTR",UC_PPC_REG_CTR},{"MSR",UC_PPC_REG_MSR},{"FPSCR",UC_PPC_REG_FPSCR},{"CR",UC_PPC_REG_CR}
    };


    const int numEntries=sizeof(register_array) / sizeof(register_array[0]);
    return index < numEntries ? register_array[index].unicorn_value : UC_PPC_REG_INVALID;
}
const char* register_name_from_int_ppc(uint64_t index)
{
    static unicorn_const_t const register_array[]={
        {"PC",UC_PPC_REG_PC},{"0",UC_PPC_REG_0},{"1",UC_PPC_REG_1},{"2",UC_PPC_REG_2},{"3",UC_PPC_REG_3},{"4",UC_PPC_REG_4},{"5",UC_PPC_REG_5},{"6",UC_PPC_REG_6},{"7",UC_PPC_REG_7},{"8",UC_PPC_REG_8},{"9",UC_PPC_REG_9},{"10",UC_PPC_REG_10},{"11",UC_PPC_REG_11},{"12",UC_PPC_REG_12},{"13",UC_PPC_REG_13},{"14",UC_PPC_REG_14},{"15",UC_PPC_REG_15},{"16",UC_PPC_REG_16},{"17",UC_PPC_REG_17},{"18",UC_PPC_REG_18},{"19",UC_PPC_REG_19},{"20",UC_PPC_REG_20},{"21",UC_PPC_REG_21},{"22",UC_PPC_REG_22},{"23",UC_PPC_REG_23},{"24",UC_PPC_REG_24},{"25",UC_PPC_REG_25},{"26",UC_PPC_REG_26},{"27",UC_PPC_REG_27},{"28",UC_PPC_REG_28},{"29",UC_PPC_REG_29},{"30",UC_PPC_REG_30},{"31",UC_PPC_REG_31},{"CR0",UC_PPC_REG_CR0},{"CR1",UC_PPC_REG_CR1},{"CR2",UC_PPC_REG_CR2},{"CR3",UC_PPC_REG_CR3},{"CR4",UC_PPC_REG_CR4},{"CR5",UC_PPC_REG_CR5},{"CR6",UC_PPC_REG_CR6},{"CR7",UC_PPC_REG_CR7},{"FPR0",UC_PPC_REG_FPR0},{"FPR1",UC_PPC_REG_FPR1},{"FPR2",UC_PPC_REG_FPR2},{"FPR3",UC_PPC_REG_FPR3},{"FPR4",UC_PPC_REG_FPR4},{"FPR5",UC_PPC_REG_FPR5},{"FPR6",UC_PPC_REG_FPR6},{"FPR7",UC_PPC_REG_FPR7},{"FPR8",UC_PPC_REG_FPR8},{"FPR9",UC_PPC_REG_FPR9},{"FPR10",UC_PPC_REG_FPR10},{"FPR11",UC_PPC_REG_FPR11},{"FPR12",UC_PPC_REG_FPR12},{"FPR13",UC_PPC_REG_FPR13},{"FPR14",UC_PPC_REG_FPR14},{"FPR15",UC_PPC_REG_FPR15},{"FPR16",UC_PPC_REG_FPR16},{"FPR17",UC_PPC_REG_FPR17},{"FPR18",UC_PPC_REG_FPR18},{"FPR19",UC_PPC_REG_FPR19},{"FPR20",UC_PPC_REG_FPR20},{"FPR21",UC_PPC_REG_FPR21},{"FPR22",UC_PPC_REG_FPR22},{"FPR23",UC_PPC_REG_FPR23},{"FPR24",UC_PPC_REG_FPR24},{"FPR25",UC_PPC_REG_FPR25},{"FPR26",UC_PPC_REG_FPR26},{"FPR27",UC_PPC_REG_FPR27},{"FPR28",UC_PPC_REG_FPR28},{"FPR29",UC_PPC_REG_FPR29},{"FPR30",UC_PPC_REG_FPR30},{"FPR31",UC_PPC_REG_FPR31},{"LR",UC_PPC_REG_LR},{"XER",UC_PPC_REG_XER},{"CTR",UC_PPC_REG_CTR},{"MSR",UC_PPC_REG_MSR},{"FPSCR",UC_PPC_REG_FPSCR},{"CR",UC_PPC_REG_CR}
    };

    const int numEntries=sizeof(register_array) / sizeof(register_array[0]);
    return index < numEntries ? register_array[index].name : "Invalid";
}
/************************************************** uc_reg_from_int_mips and register_name_from_int_mips MUST MATCH ************************************/


/**********************************************
 **** getting the integers from the name   ****
 **********************************************/
uint64_t register_int_from_name_ppc(const char* reg_name)
{
    for (int i=0;i<MAX_REGISTERS;i++)
    {
        if (strcasecmp(reg_name,register_name_from_int_ppc(i)) == 0)
        {
            return i;
        }
    }
    fprintf(stderr, "Error %s is not a valid register for ppc.\n",reg_name);
    fprintf(stderr, "Valid choices are:");
    for (int i=0;i<MAX_REGISTERS;i++)
    {
        fprintf(stderr, "%s ",register_name_from_int_ppc(i));
    }
    fprintf(stderr, "\n");
    my_exit(-1);
    return 666;  /// just here to keep the compiler happy. 
}